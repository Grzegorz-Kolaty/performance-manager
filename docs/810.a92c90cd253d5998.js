"use strict";(self.webpackChunkfrontend_performance_manager=self.webpackChunkfrontend_performance_manager||[]).push([[810],{810:(P,d,p)=>{p.r(d),p.d(d,{FillFormComponent:()=>Y});var u=p(803),r=p(9417),f=p(2341),_=p(177),v=p(2806),C=p(274),$=p(6649),F=p(9974);const T=(o,s)=>(o.push(s),o);var x=p(3089),j=p(8501),e=p(4438),c=p(7052);const h=(o,s)=>s.id,g=o=>["/create-form/template/",o];function y(o,s){1&o&&e.nrm(0,"app-loading-spinner")}function I(o,s){if(1&o&&(e.j41(0,"div",5)(1,"a",6),e.EFF(2," Wybieram ten szablon! "),e.k0s()()),2&o){const t=e.XpG(3);e.R7$(),e.Y8G("routerLink",e.eq3(1,g,t.templateId))}}function k(o,s){if(1&o&&(e.j41(0,"div",0)(1,"div",2)(2,"h3",3)(3,"b"),e.EFF(4),e.k0s()(),e.j41(5,"p",4),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.j41(8,"p"),e.EFF(9,"Wska\u017c najbardziej pasuj\u0105c\u0105 odpowiedz i podaj uzasadnienie"),e.k0s()(),e.DNE(10,I,3,3,"div",5),e.k0s()),2&o){const t=e.XpG(2);e.R7$(4),e.JRh(t.form.name),e.R7$(2),e.SpI(" Data wyga\u015bni\u0119cia ankiety: ",e.bMT(7,3,t.form.endTimestamp)," "),e.R7$(4),e.vxM(10,t.templateId?10:-1)}}function G(o,s){1&o&&(e.j41(0,"p"),e.EFF(1,"Formularz jeszcze nie ma dodanych pyta\u0144 lub jest nieprawid\u0142owy \u{1f63f}"),e.k0s())}function E(o,s){1&o&&(e.j41(0,"h5",11),e.EFF(1,"Pracownik"),e.k0s())}function S(o,s){if(1&o&&(e.j41(0,"i",21),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" (+",t.points,"pkt) ")}}function U(o,s){if(1&o&&(e.j41(0,"div",17),e.nrm(1,"input",18),e.j41(2,"label",19),e.EFF(3),e.k0s(),e.DNE(4,S,2,1,"i",20),e.k0s()),2&o){const t=s.$implicit,i=s.$index,n=e.XpG(2).$index,l=e.XpG(2);e.R7$(),e.FCK("id","question",n,"userOption",i,""),e.Y8G("value",t.id),e.BMQ("name","question-"+n+"-user-"+i),e.R7$(),e.FCK("for","question",n,"userOption",i,""),e.R7$(),e.SpI(" ",t.content," "),e.R7$(),e.Y8G("ngxPermissionsExcept",l.Role.user)}}function X(o,s){if(1&o&&(e.j41(0,"label",12),e.EFF(1),e.k0s(),e.j41(2,"div",16),e.Z7z(3,U,5,10,"div",17,h),e.k0s()),2&o){const t=e.XpG(),i=t.$implicit;e.Mz_("for","question",t.$index,""),e.R7$(),e.SpI(" ",i.selectedUserOption?"Wybrano opcj\u0119":"Wybierz opcj\u0119"," "),e.R7$(2),e.Dyx(i.options)}}function z(o,s){1&o&&(e.j41(0,"h5",11),e.EFF(1,"Prze\u0142o\u017cony"),e.k0s())}function M(o,s){if(1&o&&(e.j41(0,"i",21),e.EFF(1),e.k0s()),2&o){const t=e.XpG().$implicit;e.R7$(),e.SpI(" (+",t.points,"pkt) ")}}function O(o,s){if(1&o&&(e.j41(0,"div",17),e.nrm(1,"input",24),e.j41(2,"label",19),e.EFF(3),e.k0s(),e.DNE(4,M,2,1,"i",20),e.k0s()),2&o){const t=s.$implicit,i=s.$index,n=e.XpG(3).$index,l=e.XpG(2);e.R7$(),e.FCK("id","question",n,"supervisorOption",i,""),e.Y8G("value",t.id),e.BMQ("name","question-"+n+"-supervisor-"+i),e.R7$(),e.FCK("for","question",n,"supervisorOption",i,""),e.R7$(),e.SpI(" ",t.content," "),e.R7$(),e.Y8G("ngxPermissionsExcept",l.Role.user)}}function w(o,s){if(1&o&&(e.j41(0,"label",12),e.EFF(1),e.k0s(),e.j41(2,"div",16),e.Z7z(3,O,5,10,"div",17,h),e.k0s()),2&o){const t=e.XpG(2),i=t.$implicit;e.Mz_("for","question",t.$index,""),e.R7$(),e.SpI(" ",i.selectedUserOption?"Wybrano opcj\u0119":"Wybierz opcj\u0119"," "),e.R7$(2),e.Dyx(i.supervisorOptions)}}function N(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",22),e.DNE(1,z,2,0,"h5",11)(2,w,5,3),e.j41(3,"label",12),e.EFF(4),e.k0s(),e.nrm(5,"textarea",23),e.j41(6,"button",14),e.bIt("click",function(){e.eBV(t);const n=e.XpG(),l=n.$implicit,m=n.$index,a=e.XpG(2);return e.Njj(a.saveAnswer(l,m))}),e.EFF(7),e.k0s()()}if(2&o){const t=e.XpG(),i=t.$implicit,n=t.$index,l=e.XpG(2);e.R7$(),e.vxM(1,l.isUser?-1:1),e.R7$(),e.vxM(2,null!=i.supervisorOptions&&i.supervisorOptions.length?2:-1),e.R7$(),e.Mz_("for","question",n,"supervisorText"),e.R7$(),e.SpI(" ",i.supervisorText?"Podane uzasadnienie":"Uzasadnij wyb\xf3r"," "),e.R7$(),e.Mz_("id","question",n,"supervisorText"),e.R7$(),e.Y8G("disabled",!!i.supervisorText||l.isUser||l.templateId),e.R7$(),e.SpI(" ",i.supervisorText?"Zapisane":"Zapisz"," ")}}function D(o,s){if(1&o){const t=e.RV6();e.j41(0,"div",7)(1,"h5",8),e.EFF(2),e.k0s(),e.j41(3,"h4",9),e.EFF(4),e.k0s(),e.j41(5,"div",10),e.DNE(6,E,2,0,"h5",11)(7,X,5,3),e.j41(8,"label",12),e.EFF(9),e.k0s(),e.nrm(10,"textarea",13),e.j41(11,"button",14),e.bIt("click",function(){const n=e.eBV(t),l=n.$implicit,m=n.$index,a=e.XpG(2);return e.Njj(a.saveAnswer(l,m))}),e.EFF(12),e.k0s()(),e.DNE(13,N,8,9,"div",15),e.k0s(),e.nrm(14,"hr")}if(2&o){const t=s.$implicit,i=s.$index,n=e.XpG(2);e.Y8G("formGroupName",i),e.R7$(2),e.Lme("Pytanie ",i+1," z ",null==n.form.questions?null:n.form.questions.length,""),e.R7$(2),e.JRh(t.name),e.R7$(),e.Y8G("ngClass",n.isUser?"p-2":"bg-light p-5"),e.R7$(),e.vxM(6,n.isUser?-1:6),e.R7$(),e.vxM(7,null!=t.options&&t.options.length?7:-1),e.R7$(),e.Mz_("for","question",i,"userText"),e.R7$(),e.SpI(" ",t.userText?"Podane uzasadnienie":"Uzasadnij wyb\xf3r"," "),e.R7$(),e.Mz_("id","question",i,"userText"),e.R7$(),e.Y8G("disabled",t.userText||!n.isUser||n.templateId),e.R7$(),e.SpI(" ",t.userText?"Zapisane":"Zapisz"," "),e.R7$(),e.Y8G("ngxPermissionsExcept",n.Role.user)}}function q(o,s){if(1&o&&(e.DNE(0,k,11,5,"div",0)(1,G,2,0),e.j41(2,"form",1),e.Z7z(3,D,15,15,null,null,e.fX1),e.k0s()),2&o){const t=e.XpG();e.vxM(0,t.form&&t.form.name&&null!=t.form.questions&&t.form.questions.length?0:1),e.R7$(2),e.Y8G("formGroup",t.formGroup),e.R7$(),e.Dyx(t.form.questions)}}let Y=(()=>{class o{constructor(t,i,n,l,m,a){this.route=t,this.userService=i,this.formsService=n,this.templateService=l,this.questionService=m,this.fb=a,this.formGroup=this.fb.group({}),this.Role=x.X,this.formId="",this.templateId="",this.isUser=this.userService.currentRole===x.X.user}ngOnInit(){this.formId=this.route.snapshot.paramMap.get("formId")||"",this.templateId=this.route.snapshot.paramMap.get("templateId")||"",this.formId?this.fetchSurvey():this.templateId&&this.fetchTemplate()}fetchSurvey(){this.formsService.getFormById(this.formId).subscribe({next:t=>{this.form=t,this.initForm()}})}fetchTemplateQuestions(t){(0,v.H)(t.questions).pipe((0,C.H)(n=>this.questionService.getQuestionById(n)),function b(){return(0,F.N)((o,s)=>{(function R(o,s){return(0,F.N)((0,$.S)(o,s,arguments.length>=2,!1,!0))})(T,[])(o).subscribe(s)})}()).subscribe({next:n=>{const l={...t,questions:n};this.form=l,this.initForm()}})}fetchTemplate(){this.templateService.getTemplatesById(this.templateId).subscribe({next:t=>{this.fetchTemplateQuestions(t)}})}initForm(){const t={};this.form.questions?.forEach((i,n)=>{void 0!==i.id&&(t[n]=this.fb.group({userText:new r.MJ({value:i.userText,disabled:!!i.userText||!this.isUser||!!this.templateId},r.k0.required),selectedUserOption:new r.MJ({value:i.selectedUserOption?.id,disabled:!!i.selectedUserOption||!this.isUser||!!this.templateId},r.k0.required),supervisorText:new r.MJ({value:i.supervisorText,disabled:!!i.supervisorText||this.isUser||!!this.templateId},r.k0.required),selectedSupervisorOption:new r.MJ({value:i.selectedSupervisorOption?.id,disabled:!!i.selectedSupervisorOption||this.isUser||!!this.templateId},r.k0.required)}))}),this.formGroup=this.fb.group(t)}saveAnswer(t,i){const n=this.formGroup.get(`${i}`)?.value;console.log("formid: ",this.formId,"questionId: ",t.id,"questionUserText: ",n.userText,"selectedOptionid: ",n.selectedUserOption),t&&t.id&&n.userText&&n.selectedUserOption&&this.questionService.saveQuestionAnswer(this.formId,t.id,n,n.id)}static#e=this.\u0275fac=function(i){return new(i||o)(e.rXU(u.nX),e.rXU(c.DL),e.rXU(c.fS),e.rXU(c.ze),e.rXU(c.rp),e.rXU(r.ok))};static#t=this.\u0275cmp=e.VBU({type:o,selectors:[["app-fill-form"]],standalone:!0,features:[e.aNF],decls:2,vars:1,consts:[[1,"row"],[3,"formGroup"],[1,"col"],[1,"fw-normal","mb-2"],[1,"my-1"],[1,"col","d-flex","justify-content-center","align-items-center"],[1,"btn","btn-white","border","fw-medium","border-2","border-primary","text-nowrap","text-primary","rounded-4","py-2","px-4",3,"routerLink"],[1,"row","mt-5",3,"formGroupName"],[1,"my-2"],[1,"my-3"],[1,"col","d-flex","flex-column","flex-nowrap","justify-content-end","m-2","rounded-4",3,"ngClass"],[1,"text-center","mb-3"],[1,"form-label",3,"for"],["formControlName","userText","rows","3","type","text",1,"form-control","form-control-lg","bg-light",3,"id"],[1,"btn","btn-primary","w-25","text-white","py-2","px-4","my-3",3,"click","disabled"],["class","col d-flex flex-column flex-nowrap justify-content-end p-5 m-2 rounded-4",4,"ngxPermissionsExcept"],[1,"flex-grow-1"],[1,"d-flex","flex-row","align-items-center","fs-5","mb-3"],["type","radio","formControlName","selectedUserOption",1,"form-check-input",3,"value","id"],[1,"form-check-label","flex-grow-1",3,"for"],["class","text-muted ms-3",4,"ngxPermissionsExcept"],[1,"text-muted","ms-3"],[1,"col","d-flex","flex-column","flex-nowrap","justify-content-end","p-5","m-2","rounded-4"],["formControlName","supervisorText","rows","3","type","text",1,"form-control","form-control-lg","bg-light",3,"id"],["type","radio","formControlName","selectedSupervisorOption",1,"form-check-input",3,"value","id"]],template:function(i,n){1&i&&e.DNE(0,y,1,0,"app-loading-spinner")(1,q,5,2),2&i&&e.vxM(0,n.formsService.isProcessingSomething?0:1)},dependencies:[r.X1,r.qT,r.me,r.Fm,r.BC,r.cb,r.j4,r.JD,r.$R,_.YU,f.Ov,f.f6,_.vh,j.N,u.Wk],encapsulation:2})}return o})()}}]);